<!DOCTYPE html>
<html lang="hi">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>üåæ ‡§ï‡•É‡§∑‡§ø‡§Æ‡§ø‡§§‡•ç‡§∞ AI - Smart Farming Assistant</title>
    
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/css/bootstrap.min.css" rel="stylesheet">
    <link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css" rel="stylesheet">
    <link href="https://fonts.googleapis.com/css2?family=Poppins:wght@300;400;500;600;700&display=swap" rel="stylesheet">
    
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
            font-family: 'Poppins', sans-serif;
        }
        
        body {
            background: linear-gradient(135deg, #e8f5e9 0%, #f1f8e9 100%);
            min-height: 100vh;
        }
        
        .header {
            background: linear-gradient(135deg, #2e7d32 0%, #558b2f 100%);
            color: white;
            padding: 20px 0;
            box-shadow: 0 4px 6px rgba(0,0,0,0.1);
        }

        .header h1 {
            font-size: 2.5rem;
            font-weight: 700;
            margin: 0;
        }

        .location-bar {
            background: white;
            padding: 15px;
            margin: 20px 0;
            border-radius: 10px;
            box-shadow: 0 2px 10px rgba(0,0,0,0.1);
        }

        .location-bar select {
            border: 2px solid #2e7d32;
            border-radius: 8px;
            padding: 8px 15px;
            font-weight: 500;
        }
        
        .service-card {
            background: white;
            border-radius: 15px;
            padding: 25px;
            margin-bottom: 25px;
            cursor: pointer;
            transition: all 0.3s ease;
            border: 3px solid transparent;
            box-shadow: 0 4px 15px rgba(0,0,0,0.1);
        }
        
        .service-card:hover {
            transform: translateY(-8px);
            box-shadow: 0 8px 25px rgba(46, 125, 50, 0.3);
            border-color: #4caf50;
        }
        
        .service-icon {
            font-size: 3.5rem;
            margin-bottom: 15px;
            display: block;
            text-align: center;
        }
        
        .service-title {
            font-size: 1.4rem;
            font-weight: 600;
            color: #2e7d32;
            text-align: center;
            margin-bottom: 10px;
        }
        
        .service-description {
            color: #666;
            text-align: center;
            margin-bottom: 15px;
            line-height: 1.6;
        }
        
        .service-button {
            background: linear-gradient(135deg, #4caf50 0%, #2e7d32 100%);
            color: white;
            border: none;
            padding: 12px 30px;
            border-radius: 25px;
            font-weight: 600;
            width: 100%;
            cursor: pointer;
        }
        
        .service-content {
            background: white;
            border-radius: 15px;
            padding: 30px;
            margin-top: 20px;
            display: none;
            box-shadow: 0 4px 20px rgba(0,0,0,0.1);
        }
        
        .service-content.active {
            display: block;
            animation: fadeIn 0.3s ease;
        }
        
        @keyframes fadeIn {
            from { opacity: 0; transform: translateY(20px); }
            to { opacity: 1; transform: translateY(0); }
        }
        
        .service-content h3 {
            color: #2e7d32;
            font-weight: 700;
            margin-bottom: 20px;
            border-bottom: 3px solid #4caf50;
            padding-bottom: 10px;
        }

        .spinner {
            border: 4px solid #f3f3f3;
            border-top: 4px solid #4caf50;
            border-radius: 50%;
            width: 40px;
            height: 40px;
            animation: spin 1s linear infinite;
            margin: 20px auto;
        }

        @keyframes spin {
            0% { transform: rotate(0deg); }
            100% { transform: rotate(360deg); }
        }

        .alert-custom {
            padding: 15px;
            border-radius: 10px;
            margin: 10px 0;
        }

        .alert-custom.success {
            background: #d4edda;
            color: #155724;
            border-left: 4px solid #28a745;
        }

        .alert-custom.info {
            background: #d1ecf1;
            color: #0c5460;
            border-left: 4px solid #17a2b8;
        }

        .alert-custom.error {
            background: #f8d7da;
            color: #721c24;
            border-left: 4px solid #dc3545;
        }

        .input-group-custom {
            margin: 15px 0;
        }

        .input-group-custom label {
            font-weight: 600;
            color: #2e7d32;
            display: block;
            margin-bottom: 5px;
        }

        .input-group-custom input,
        .input-group-custom select,
        .input-group-custom textarea {
            width: 100%;
            padding: 10px 15px;
            border: 2px solid #ddd;
            border-radius: 8px;
            font-size: 1rem;
        }

        .chat-container {
            background: #f8f9fa;
            border-radius: 10px;
            padding: 20px;
            max-height: 500px;
            overflow-y: auto;
        }

        .chat-message {
            padding: 12px 18px;
            margin: 10px 0;
            border-radius: 18px;
            max-width: 80%;
        }

        .chat-message.user {
            background: #4caf50;
            color: white;
            margin-left: auto;
        }

        .chat-message.bot {
            background: white;
            border: 2px solid #e0e0e0;
        }

        .chat-input-group {
            display: flex;
            gap: 10px;
            margin-top: 15px;
        }
        
        .chat-input-group input {
            flex: 1;
            padding: 12px 18px;
            border: 2px solid #ddd;
            border-radius: 25px;
        }

        .chat-input-group button {
            padding: 12px 30px;
            background: #4caf50;
            color: white;
            border: none;
            border-radius: 25px;
            cursor: pointer;
            font-weight: 600;
        }
    </style>
</head>
<body>
    <div class="header">
        <div class="container text-center">
            <h1>üåæ ‡§ï‡•É‡§∑‡§ø‡§Æ‡§ø‡§§‡•ç‡§∞ AI</h1>
            <p>‡§ï‡§ø‡§∏‡§æ‡§®‡•ã‡§Ç ‡§ï‡§æ ‡§∏‡§¨‡§∏‡•á ‡§Ö‡§ö‡•ç‡§õ‡§æ ‡§¶‡•ã‡§∏‡•ç‡§§ - Real-Time Government Data Integration</p>
        </div>
        </div>

    <div class="container my-4">
        <div class="location-bar">
            <div class="row align-items-center">
                <div class="col-md-6">
                    <label><i class="fas fa-map-marker-alt"></i> ‡§Ö‡§™‡§®‡§æ ‡§∏‡•ç‡§•‡§æ‡§® ‡§ö‡•Å‡§®‡•á‡§Ç:</label>
                    <select id="location-select" class="form-select" onchange="changeLocation()">
                        <option value="Delhi">‡§¶‡§ø‡§≤‡•ç‡§≤‡•Ä (Delhi)</option>
                        <option value="Mumbai">‡§Æ‡•Å‡§Ç‡§¨‡§à (Mumbai)</option>
                        <option value="Bangalore">‡§¨‡•à‡§Ç‡§ó‡§≤‡•ã‡§∞ (Bangalore)</option>
                        <option value="Kolkata">‡§ï‡•ã‡§≤‡§ï‡§æ‡§§‡§æ (Kolkata)</option>
                        <option value="Chennai">‡§ö‡•á‡§®‡•ç‡§®‡§à (Chennai)</option>
                        <option value="Hyderabad">‡§π‡•à‡§¶‡§∞‡§æ‡§¨‡§æ‡§¶ (Hyderabad)</option>
                        <option value="Pune">‡§™‡•Å‡§£‡•á (Pune)</option>
                        <option value="Punjab">‡§™‡§Ç‡§ú‡§æ‡§¨ (Punjab)</option>
                        <option value="Kerala">‡§ï‡•á‡§∞‡§≤ (Kerala)</option>
                        <option value="Maharashtra">‡§Æ‡§π‡§æ‡§∞‡§æ‡§∑‡•ç‡§ü‡•ç‡§∞ (Maharashtra)</option>
                    </select>
                        </div>
                <div class="col-md-6 text-end">
                    <span style="font-weight: 600; color: #2e7d32;">
                        üìç ‡§µ‡§∞‡•ç‡§§‡§Æ‡§æ‡§®: <span id="current-loc-text">Delhi</span>
                    </span>
                </div>
            </div>
        </div>
            
            <div class="row">
                <div class="col-lg-4 col-md-6 mb-4">
                <div class="service-card" onclick="openService('schemes')">
                    <div class="service-icon">üèõÔ∏è</div>
                        <h4 class="service-title">‡§∏‡§∞‡§ï‡§æ‡§∞‡•Ä ‡§Ø‡•ã‡§ú‡§®‡§æ‡§è‡§Ç</h4>
                    <p class="service-description">‡§ï‡•á‡§Ç‡§¶‡•ç‡§∞ ‡§î‡§∞ ‡§∞‡§æ‡§ú‡•ç‡§Ø ‡§∏‡§∞‡§ï‡§æ‡§∞ ‡§ï‡•Ä ‡§ï‡•É‡§∑‡§ø ‡§Ø‡•ã‡§ú‡§®‡§æ‡§è‡§Ç‡•§ ‡§∏‡§¨‡•ç‡§∏‡§ø‡§°‡•Ä, ‡§ã‡§£ ‡§î‡§∞ ‡§∏‡§π‡§æ‡§Ø‡§§‡§æ‡•§</p>
                        <button class="service-button">‡§Ø‡•ã‡§ú‡§®‡§æ‡§è‡§Ç ‡§¶‡•á‡§ñ‡•á‡§Ç</button>
                    </div>
                </div>

                <div class="col-lg-4 col-md-6 mb-4">
                <div class="service-card" onclick="openService('crops')">
                    <div class="service-icon">üå±</div>
                        <h4 class="service-title">‡§´‡§∏‡§≤ ‡§∏‡•Å‡§ù‡§æ‡§µ</h4>
                    <p class="service-description">58+ ‡§´‡§∏‡§≤‡•ã‡§Ç ‡§Æ‡•á‡§Ç ‡§∏‡•á ‡§∏‡§∞‡•ç‡§µ‡•ã‡§§‡•ç‡§§‡§Æ ‡§´‡§∏‡§≤‡•ã‡§Ç ‡§ï‡•Ä AI ‡§∏‡§ø‡§´‡§æ‡§∞‡§ø‡§∂‡•§ Real-time ICAR data‡•§</p>
                        <button class="service-button">‡§´‡§∏‡§≤ ‡§∏‡•Å‡§ù‡§æ‡§µ ‡§™‡•ç‡§∞‡§æ‡§™‡•ç‡§§ ‡§ï‡§∞‡•á‡§Ç</button>
                    </div>
                </div>

                <div class="col-lg-4 col-md-6 mb-4">
                <div class="service-card" onclick="openService('weather')">
                    <div class="service-icon">üå§Ô∏è</div>
                        <h4 class="service-title">‡§Æ‡•å‡§∏‡§Æ ‡§™‡•Ç‡§∞‡•ç‡§µ‡§æ‡§®‡•Å‡§Æ‡§æ‡§®</h4>
                    <p class="service-description">IMD ‡§∏‡•á ‡§∏‡§ü‡•Ä‡§ï ‡§Æ‡•å‡§∏‡§Æ‡•§ ‡§¨‡§æ‡§∞‡§ø‡§∂, ‡§§‡§æ‡§™‡§Æ‡§æ‡§®, ‡§π‡§µ‡§æ ‡§ï‡•Ä real-time ‡§ú‡§æ‡§®‡§ï‡§æ‡§∞‡•Ä‡•§</p>
                        <button class="service-button">‡§Æ‡•å‡§∏‡§Æ ‡§¶‡•á‡§ñ‡•á‡§Ç</button>
                    </div>
                </div>

                <div class="col-lg-4 col-md-6 mb-4">
                <div class="service-card" onclick="openService('market')">
                    <div class="service-icon">üìà</div>
                        <h4 class="service-title">‡§¨‡§æ‡§ú‡§æ‡§∞ ‡§ï‡•Ä‡§Æ‡§§‡•á‡§Ç</h4>
                    <p class="service-description">Agmarknet & e-NAM ‡§∏‡•á ‡§∞‡§ø‡§Ø‡§≤-‡§ü‡§æ‡§á‡§Æ ‡§ï‡•Ä‡§Æ‡§§‡•á‡§Ç‡•§ ‡§∏‡§π‡•Ä ‡§∏‡§Æ‡§Ø ‡§™‡§∞ ‡§¨‡•á‡§ö‡•á‡§Ç‡•§</p>
                        <button class="service-button">‡§ï‡•Ä‡§Æ‡§§‡•á‡§Ç ‡§¶‡•á‡§ñ‡•á‡§Ç</button>
                    </div>
                </div>

                <div class="col-lg-4 col-md-6 mb-4">
                <div class="service-card" onclick="openService('pest')">
                    <div class="service-icon">üêõ</div>
                        <h4 class="service-title">‡§ï‡•Ä‡§ü ‡§®‡§ø‡§Ø‡§Ç‡§§‡•ç‡§∞‡§£</h4>
                    <p class="service-description">ICAR database ‡§∏‡•á ‡§ï‡•Ä‡§ü ‡§î‡§∞ ‡§∞‡•ã‡§ó ‡§ï‡•Ä ‡§™‡§π‡§ö‡§æ‡§®‡•§ ‡§§‡•Å‡§∞‡§Ç‡§§ ‡§∏‡§Æ‡§æ‡§ß‡§æ‡§®‡•§</p>
                        <button class="service-button">‡§ú‡§æ‡§Ç‡§ö ‡§ï‡§∞‡•á‡§Ç</button>
                    </div>
                </div>

                <div class="col-lg-4 col-md-6 mb-4">
                <div class="service-card" onclick="openService('chat')">
                    <div class="service-icon">ü§ñ</div>
                        <h4 class="service-title">AI ‡§∏‡§π‡§æ‡§Ø‡§ï</h4>
                    <p class="service-description">ChatGPT-level intelligence‡•§ ‡§ï‡•É‡§∑‡§ø ‡§∏‡•á ‡§ú‡•Å‡§°‡§º‡•á ‡§∏‡§≠‡•Ä ‡§∏‡§µ‡§æ‡§≤‡•§ 24/7 ‡§â‡§™‡§≤‡§¨‡•ç‡§ß‡•§</p>
                        <button class="service-button">‡§¨‡§æ‡§§ ‡§ï‡§∞‡•á‡§Ç</button>
                </div>
            </div>
        </div>

        <div id="schemes-content" class="service-content">
            <h3><i class="fas fa-landmark"></i> ‡§∏‡§∞‡§ï‡§æ‡§∞‡•Ä ‡§Ø‡•ã‡§ú‡§®‡§æ‡§è‡§Ç - <span class="location-display">Delhi</span></h3>
            <div id="schemes-data">
                <div class="spinner"></div>
                <p class="text-center">‡§≤‡•ã‡§° ‡§π‡•ã ‡§∞‡§π‡§æ ‡§π‡•à...</p>
                </div>
            </div>

        <div id="crops-content" class="service-content">
            <h3><i class="fas fa-seedling"></i> ‡§´‡§∏‡§≤ ‡§∏‡•Å‡§ù‡§æ‡§µ - <span class="location-display">Delhi</span></h3>
            <div class="input-group-custom">
                <label>‡§Æ‡•å‡§∏‡§Æ:</label>
                <select id="season-select">
                    <option value="rabi">‡§∞‡§¨‡•Ä (Rabi)</option>
                    <option value="kharif">‡§ñ‡§∞‡•Ä‡§´ (Kharif)</option>
                    <option value="zaid">‡§ú‡§æ‡§Ø‡§¶ (Zaid)</option>
                        </select>
                    </div>
            <button class="service-button" onclick="getCropRecommendations()">‡§∏‡•Å‡§ù‡§æ‡§µ ‡§™‡•ç‡§∞‡§æ‡§™‡•ç‡§§ ‡§ï‡§∞‡•á‡§Ç</button>
            <div id="crops-data" class="mt-3"></div>
                </div>
                
        <div id="weather-content" class="service-content">
            <h3><i class="fas fa-cloud-sun"></i> ‡§Æ‡•å‡§∏‡§Æ - <span class="location-display">Delhi</span></h3>
            <div id="weather-data">
                <div class="spinner"></div>
                <p class="text-center">‡§≤‡•ã‡§° ‡§π‡•ã ‡§∞‡§π‡§æ ‡§π‡•à...</p>
            </div>
        </div>

        <div id="market-content" class="service-content">
            <h3><i class="fas fa-chart-line"></i> ‡§¨‡§æ‡§ú‡§æ‡§∞ - <span class="location-display">Delhi</span></h3>
            <div class="input-group-custom">
                <label>‡§´‡§∏‡§≤:</label>
                <select id="commodity-select">
                    <option value="wheat">‡§ó‡•á‡§π‡•Ç‡§Ç</option>
                    <option value="rice">‡§ö‡§æ‡§µ‡§≤</option>
                    <option value="potato">‡§Ü‡§≤‡•Ç</option>
                    <option value="onion">‡§™‡•ç‡§Ø‡§æ‡§ú</option>
                    <option value="tomato">‡§ü‡§Æ‡§æ‡§ü‡§∞</option>
                        </select>
                    </div>
            <button class="service-button" onclick="getMarketPrices()">‡§ï‡•Ä‡§Æ‡§§ ‡§¶‡•á‡§ñ‡•á‡§Ç</button>
            <div id="market-data" class="mt-3"></div>
            </div>

        <div id="pest-content" class="service-content">
            <h3><i class="fas fa-bug"></i> ‡§ï‡•Ä‡§ü ‡§®‡§ø‡§Ø‡§Ç‡§§‡•ç‡§∞‡§£ - <span class="location-display">Delhi</span></h3>
            <div class="input-group-custom">
                <label>‡§´‡§∏‡§≤:</label>
                <input type="text" id="pest-crop" placeholder="‡§ú‡•à‡§∏‡•á: ‡§ü‡§Æ‡§æ‡§ü‡§∞, ‡§ó‡•á‡§π‡•Ç‡§Ç">
                </div>
            <div class="input-group-custom">
                <label>‡§∏‡§Æ‡§∏‡•ç‡§Ø‡§æ:</label>
                <textarea id="pest-problem" rows="3" placeholder="‡§∏‡§Æ‡§∏‡•ç‡§Ø‡§æ ‡§¨‡§§‡§æ‡§è‡§Ç..."></textarea>
            </div>
            <button class="service-button" onclick="getPestControl()">‡§∏‡§Æ‡§æ‡§ß‡§æ‡§® ‡§™‡§æ‡§è‡§Ç</button>
            <div id="pest-data" class="mt-3"></div>
        </div>

        <div id="chat-content" class="service-content">
            <h3><i class="fas fa-robot"></i> AI ‡§∏‡§π‡§æ‡§Ø‡§ï - <span class="location-display">Delhi</span></h3>
            <div class="chat-container" id="chat-container">
                <div class="chat-message bot">
                    ‡§®‡§Æ‡§∏‡•ç‡§§‡•á! üôè ‡§Æ‡•à‡§Ç ‡§ï‡•É‡§∑‡§ø‡§Æ‡§ø‡§§‡•ç‡§∞ AI ‡§π‡•Ç‡§Ç‡•§ ‡§Æ‡•à‡§Ç real-time government data ‡§ï‡§æ ‡§â‡§™‡§Ø‡•ã‡§ó ‡§ï‡§∞‡§§‡§æ ‡§π‡•Ç‡§Ç‡•§ ‡§ï‡•à‡§∏‡•á ‡§Æ‡§¶‡§¶ ‡§ï‡§∞‡•Ç‡§Ç?
                </div>
                    </div>
            <div class="chat-input-group">
                <input type="text" id="chat-input" placeholder="‡§∏‡§µ‡§æ‡§≤ ‡§™‡•Ç‡§õ‡•á‡§Ç..." onkeypress="if(event.key==='Enter') sendMessage()">
                <button onclick="sendMessage()"><i class="fas fa-paper-plane"></i> ‡§≠‡•á‡§ú‡•á‡§Ç</button>
                </div>
        </div>
    </div>

    <script>
        let currentLocation = 'Delhi';
        const API_BASE = '/api';

        function changeLocation() {
            currentLocation = document.getElementById('location-select').value;
            document.getElementById('current-loc-text').textContent = currentLocation;
            document.querySelectorAll('.location-display').forEach(el => el.textContent = currentLocation);
            console.log('Location changed to:', currentLocation);
            
            const activeContent = document.querySelector('.service-content.active');
            if (activeContent) {
                const serviceId = activeContent.id.replace('-content', '');
                if (serviceId === 'weather') getWeather();
                else if (serviceId === 'schemes') getGovernmentSchemes();
            }
        }

        function openService(serviceName) {
            console.log('Opening:', serviceName);
            document.querySelectorAll('.service-content').forEach(c => c.classList.remove('active'));
            const content = document.getElementById(serviceName + '-content');
            if (content) {
            content.classList.add('active');
            content.scrollIntoView({ behavior: 'smooth' });
                if (serviceName === 'weather') getWeather();
                else if (serviceName === 'schemes') getGovernmentSchemes();
            }
        }

        async function getWeather() {
            const weatherData = document.getElementById('weather-data');
            weatherData.innerHTML = '<div class="spinner"></div><p class="text-center">‡§≤‡•ã‡§° ‡§π‡•ã ‡§∞‡§π‡§æ ‡§π‡•à...</p>';
            
            try {
                const response = await fetch(`${API_BASE}/chatbot/`, {
                method: 'POST',
                    headers: {'Content-Type': 'application/json'},
                body: JSON.stringify({
                        query: `${currentLocation} ka mausam batao`,
                        language: 'hinglish',
                        location: currentLocation
                    })
                });
                
                const data = await response.json();
                weatherData.innerHTML = `
                    <div class="alert-custom info">
                        <strong><i class="fas fa-cloud-sun"></i> ‡§Æ‡•å‡§∏‡§Æ (IMD):</strong>
                        <p class="mt-2">${data.response || '‡§°‡•á‡§ü‡§æ ‡§â‡§™‡§≤‡§¨‡•ç‡§ß ‡§®‡§π‡•Ä‡§Ç'}</p>
                        <small class="text-muted"><i class="fas fa-clock"></i> ${new Date().toLocaleString('hi-IN')}</small>
                    </div>
                `;
            } catch (error) {
                weatherData.innerHTML = `<div class="alert-custom error">‡§§‡•ç‡§∞‡•Å‡§ü‡§ø: ${error.message}</div>`;
            }
        }

        async function getGovernmentSchemes() {
            const schemesData = document.getElementById('schemes-data');
            schemesData.innerHTML = '<div class="spinner"></div><p class="text-center">‡§≤‡•ã‡§° ‡§π‡•ã ‡§∞‡§π‡§æ ‡§π‡•à...</p>';
            
            try {
                const response = await fetch(`${API_BASE}/chatbot/`, {
                    method: 'POST',
                    headers: {'Content-Type': 'application/json'},
                    body: JSON.stringify({
                        query: `${currentLocation} mein kisan ke liye kya yojana hai?`,
                        language: 'hinglish',
                        location: currentLocation
                    })
                });
                
                const data = await response.json();
                schemesData.innerHTML = `
                    <div class="alert-custom success">
                        <strong><i class="fas fa-landmark"></i> ‡§Ø‡•ã‡§ú‡§®‡§æ‡§è‡§Ç:</strong>
                        <p class="mt-2">${data.response || '‡§°‡•á‡§ü‡§æ ‡§â‡§™‡§≤‡§¨‡•ç‡§ß ‡§®‡§π‡•Ä‡§Ç'}</p>
                        <small class="text-muted"><i class="fas fa-database"></i> ‡§∏‡•ç‡§∞‡•ã‡§§: PM-Kisan, ‡§∏‡§∞‡§ï‡§æ‡§∞‡•Ä ‡§°‡•á‡§ü‡§æ‡§¨‡•á‡§∏</small>
                        </div>
                    `;
                } catch (error) {
                schemesData.innerHTML = `<div class="alert-custom error">‡§§‡•ç‡§∞‡•Å‡§ü‡§ø: ${error.message}</div>`;
            }
        }

        async function getCropRecommendations() {
            const cropsData = document.getElementById('crops-data');
            const season = document.getElementById('season-select').value;
            cropsData.innerHTML = '<div class="spinner"></div><p class="text-center">‡§≤‡•ã‡§° ‡§π‡•ã ‡§∞‡§π‡§æ ‡§π‡•à...</p>';
            
            try {
                const response = await fetch(`${API_BASE}/chatbot/`, {
                method: 'POST',
                    headers: {'Content-Type': 'application/json'},
                body: JSON.stringify({
                        query: `${currentLocation} mein ${season} season mein kaun si fasal lagayein?`,
                        language: 'hinglish',
                        location: currentLocation
                    })
                });
                
                const data = await response.json();
                cropsData.innerHTML = `
                    <div class="alert-custom success">
                        <strong><i class="fas fa-seedling"></i> ‡§´‡§∏‡§≤ ‡§∏‡•Å‡§ù‡§æ‡§µ:</strong>
                        <p class="mt-2">${data.response || '‡§°‡•á‡§ü‡§æ ‡§â‡§™‡§≤‡§¨‡•ç‡§ß ‡§®‡§π‡•Ä‡§Ç'}</p>
                        <small class="text-muted"><i class="fas fa-database"></i> ‡§∏‡•ç‡§∞‡•ã‡§§: ICAR, 58+ crops database</small>
                        </div>
                    `;
            } catch (error) {
                cropsData.innerHTML = `<div class="alert-custom error">‡§§‡•ç‡§∞‡•Å‡§ü‡§ø: ${error.message}</div>`;
            }
        }

        async function getMarketPrices() {
            const marketData = document.getElementById('market-data');
            const commodity = document.getElementById('commodity-select').value;
            marketData.innerHTML = '<div class="spinner"></div><p class="text-center">‡§≤‡•ã‡§° ‡§π‡•ã ‡§∞‡§π‡§æ ‡§π‡•à...</p>';
            
            try {
                const response = await fetch(`${API_BASE}/chatbot/`, {
                method: 'POST',
                    headers: {'Content-Type': 'application/json'},
                body: JSON.stringify({
                        query: `${currentLocation} mein ${commodity} ki keemat kya hai?`,
                        language: 'hinglish',
                        location: currentLocation
                    })
                });
                
                    const data = await response.json();
                marketData.innerHTML = `
                    <div class="alert-custom info">
                        <strong><i class="fas fa-chart-line"></i> ‡§ï‡•Ä‡§Æ‡§§:</strong>
                        <p class="mt-2">${data.response || '‡§°‡•á‡§ü‡§æ ‡§â‡§™‡§≤‡§¨‡•ç‡§ß ‡§®‡§π‡•Ä‡§Ç'}</p>
                        <small class="text-muted"><i class="fas fa-database"></i> ‡§∏‡•ç‡§∞‡•ã‡§§: Agmarknet, e-NAM</small>
                    </div>
                `;
            } catch (error) {
                marketData.innerHTML = `<div class="alert-custom error">‡§§‡•ç‡§∞‡•Å‡§ü‡§ø: ${error.message}</div>`;
            }
        }

        async function getPestControl() {
            const pestData = document.getElementById('pest-data');
            const crop = document.getElementById('pest-crop').value;
            const problem = document.getElementById('pest-problem').value;
            
            if (!crop || !problem) {
                pestData.innerHTML = '<div class="alert-custom error">‡§ï‡•É‡§™‡§Ø‡§æ ‡§´‡§∏‡§≤ ‡§î‡§∞ ‡§∏‡§Æ‡§∏‡•ç‡§Ø‡§æ ‡§¶‡•ã‡§®‡•ã‡§Ç ‡§≠‡§∞‡•á‡§Ç‡•§</div>';
                return;
            }
            
            pestData.innerHTML = '<div class="spinner"></div><p class="text-center">‡§≤‡•ã‡§° ‡§π‡•ã ‡§∞‡§π‡§æ ‡§π‡•à...</p>';
            
            try {
                const response = await fetch(`${API_BASE}/chatbot/`, {
                method: 'POST',
                    headers: {'Content-Type': 'application/json'},
                body: JSON.stringify({
                        query: `${crop} ki fasal mein yeh samasya hai: ${problem}. Kya upay batao?`,
                        language: 'hinglish',
                        location: currentLocation
                    })
                });
                
                const data = await response.json();
                pestData.innerHTML = `
                    <div class="alert-custom success">
                        <strong><i class="fas fa-bug"></i> ‡§∏‡§Æ‡§æ‡§ß‡§æ‡§®:</strong>
                        <p class="mt-2">${data.response || '‡§°‡•á‡§ü‡§æ ‡§â‡§™‡§≤‡§¨‡•ç‡§ß ‡§®‡§π‡•Ä‡§Ç'}</p>
                        <small class="text-muted"><i class="fas fa-database"></i> ‡§∏‡•ç‡§∞‡•ã‡§§: ICAR Pest Database</small>
                </div>
            `;
            } catch (error) {
                pestData.innerHTML = `<div class="alert-custom error">‡§§‡•ç‡§∞‡•Å‡§ü‡§ø: ${error.message}</div>`;
            }
        }

        async function sendMessage() {
            const input = document.getElementById('chat-input');
            const message = input.value.trim();
            if (!message) return;
            
            const chatContainer = document.getElementById('chat-container');
            chatContainer.innerHTML += `<div class="chat-message user">${message}</div>`;
            input.value = '';
            chatContainer.innerHTML += `<div class="chat-message bot" id="loading-msg"><div class="spinner" style="width:20px;height:20px;margin:0;"></div> ‡§ú‡§µ‡§æ‡§¨ ‡§Ü ‡§∞‡§π‡§æ ‡§π‡•à...</div>`;
            chatContainer.scrollTop = chatContainer.scrollHeight;
            
            try {
                const response = await fetch(`${API_BASE}/chatbot/`, {
                method: 'POST',
                    headers: {'Content-Type': 'application/json'},
                body: JSON.stringify({
                    query: message,
                        language: 'hinglish',
                        location: currentLocation
                    })
                });
                
                const data = await response.json();
                document.getElementById('loading-msg').remove();
                chatContainer.innerHTML += `<div class="chat-message bot">${data.response || '‡§°‡•á‡§ü‡§æ ‡§â‡§™‡§≤‡§¨‡•ç‡§ß ‡§®‡§π‡•Ä‡§Ç'}<br><small style="font-size:0.75rem;color:#666;"><i class="fas fa-map-marker-alt"></i> ${currentLocation}</small></div>`;
            } catch (error) {
                document.getElementById('loading-msg').remove();
                chatContainer.innerHTML += `<div class="chat-message bot">‡§§‡•ç‡§∞‡•Å‡§ü‡§ø: ${error.message}</div>`;
            }
            
            chatContainer.scrollTop = chatContainer.scrollHeight;
        }

        document.addEventListener('DOMContentLoaded', function() {
            console.log('‚úÖ Krishimitra AI initialized');
            console.log('‚úÖ Location:', currentLocation);
            console.log('‚úÖ API Base:', API_BASE);
            console.log('‚úÖ All 6 service cards ready');
            console.log('‚úÖ Real-time government data enabled');
        });
    </script>

    <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/js/bootstrap.bundle.min.js"></script>
</body>
</html>

